---
title: "A network meta-analysis of employment and skills interventions designed to assist young people to enter the labour market in high income countries: supplementary material"
date: 28 February 2024
author: 
  - name: David Taylor
    affiliation: Monash University
    orcid: 0000-0001-8801-7488
  - name: Rebecca Featherston
    affiliation: Monash University
    orcid:
  - name: Eleanor Ott
    affiliation: Centre for Evidence and Implementation
    orcid:
  - name: Becci Newton
    affiliation: Institute for Employment Studies
    orcid:
  - name: Emily Tanner-Smith
    affiliation: University of Oregon
    orcid:    
  - name: Aron Shlonsky
    affiliation: Monash University
    orcid: 0000-0001-8096-726X
citation:
  doi: "TBD"
  url: https://davetayl-r.github.io/youth-employment-nma/
bibliography: youth-employment-nma-references.bib
csl: apa-sixth-edition.csl
link-citations: true
format: 
  html: 
    number-sections: true
    highlight-style: ayu
    in_header: styles.css
    default-image-extension: png
knitr:
  opts_chunk:
    out.width: "100%"
tbl-cap-location: "top"
fig-cap-location: "top"
---

```{r}
#| echo: false
#| message: false
#| warning: false
#| name: care-leaver-review-global-options
#| label: global-options

# load required packages
library(tidyverse)
library(stringr)
library(readxl)
library(meta)
library(netmeta)
library(dmetar)
library(ggplot2)
library(viridis)
library(scales)
library(viscomp)
library(kableExtra)

# set knitr defaults
knitr::knit_hooks$set(crop = knitr::hook_pdfcrop)
```

# About

This page contains supplementary material for a network meta-analysis titled <i>"A network meta-analysis of employment and skills interventions designed to assist young people to enter the labour market in high income countries"</i>.

The following information is provided here:

-   <b>Identification and selection of relevant studies</b> --- this section contains additional information on our search strategy
-   <b>Extraction and transformation of information from relevant studies</b> --- this section contains information on a) what we extracted from included studies, b) how we selected outcomes where multiple options existed and c) a log of decisions we made in the transformation of reported resutls into a common effect size
-   <b>Supplementary information about included and excluded studies</b> --- this section contains information on a) how we distinguished between multiple reports of the same study, b) studies we rejected at full-text review and c) details of studies that reported outcomes they we were not able to to quantitatively synthesise in a network meta-analysis.
-   <b>Analysis of relevant studies</b> --- this section contains the full results of the quantitative synthesis that we undertook, including interaction models, subgroup analysis, sensitivity analysis, publication bias assessments and incoherence assessments.

The analysis code is available in a [GitHub repository](https://github.com/davetayl-r/youth-employment-nma-paper).

# Identification and selection of relevant studies

## Additional detail on search strategy

All impact evaluations classified as either 'low', 'medium' or 'high-quality' included in the @apunyo2022interventionsincreaseyouth EGM were screened for relevance if they appeared in any of the following intervention categories (as defined by the EGM):

-   Life skills

-   Internship and apprenticeships

-   Employee mentoring (inc. on-the-job training)

These categories were further filtered using the following outcome categories:

-   Employment status and duration

-   Hours worked

-   Earnings and salary

-   Education completion and qualification

## Grey literature search strategy

+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| Source                                                                                                     | Search method                                                                                                                                                                                                              | Date searched |
+============================================================================================================+============================================================================================================================================================================================================================+===============+
| Pathways to Work Evidence Clearinghouse                                                                    | All programs and/or interventions for "young adults (aged 16-24)" were reviewed                                                                                                                                            | 23/08/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| Clearinghouse for Labor Evaluation and Research (CLEAR)                                                    | We searched the term "youth employment" and "evaluation" and screened all studies for relevance.                                                                                                                           | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| United Kingdom Department for Work and Pensions (DWP)                                                      | We searched "youth employment" and "evaluation."                                                                                                                                                                           | 11/07/2022    |
|                                                                                                            |                                                                                                                                                                                                                            |               |
|                                                                                                            | Additionally, we searched the data archive by category of subject "young people."                                                                                                                                          |               |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| United Kingdom Department for Education (DfE)                                                              | We searched the national archives using the adult learning and workplace training filters.                                                                                                                                 | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| United States Administration for Children and Families, Office of Planning, Research and Evaluation (OPRE) | We searched using the terms "youth employment" and "evaluat\*"                                                                                                                                                             | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| Organisation for Economic Co-operation and Development (OECD)                                              | We searched using:                                                                                                                                                                                                         | 11/07/2022    |
|                                                                                                            |                                                                                                                                                                                                                            |               |
|                                                                                                            | *(All Fields contains '"youth employment"') from (Language contains 'en') AND from (All Fields contains 'evaluat\*') AND from (IGO collection contains '"igo/oecd"') with type(s) subtype/article OR subtype/workingpaper* |               |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| World Bank                                                                                                 | We searched using the terms "youth employment" and "evaluat\*".                                                                                                                                                            | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| Institute of Labor Economics (IZA)                                                                         | We searched using the terms "youth employment" and "evaluat\*".                                                                                                                                                            | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| MDRC                                                                                                       | We searched using the term "youth employment" with the publication filter set to report/working paper/brief.                                                                                                               | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
| Google Scholar                                                                                             | The first fifty results using the following search terms were reviewed: "Youth Employment" + "evaluat\*                                                                                                                    | 11/07/2022    |
+------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+

: Additional sources and methods used to identify relevant studies {#tbl-ye-nma-additional-sources-lit} {tbl-colwidths="\[30,60,10\]"}

+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| PICOSS           | Inclusion Criteria                                                                                   | Exclusion Criteria                                                                                                                                           |
+==================+======================================================================================================+==============================================================================================================================================================+
| **Population**   | Young people aged between 16 and 30                                                                  | Young people aged less than 16 or over 30                                                                                                                    |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Intervention** | Programs or Interventions need to involve the provision of one or more of the following components:  | Interventions that solely involve other components                                                                                                           |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Apprenticeships,                                                                                 |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Basic Skills,                                                                                    |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Life Skills,                                                                                     |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   On-the-job training,                                                                             |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Off-the-job training, or                                                                         |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Coaching and Mentoring                                                                           |                                                                                                                                                              |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Comparison**   | Usual services, no intervention, other services, or wait-list control                                | Studies using other comparators                                                                                                                              |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Outcome**      | Studies that examine:                                                                                | Studies that examine other outcomes                                                                                                                          |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | *Primary outcome*                                                                                    |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Employment (i.e., employment status, hours worked or earnings and salary)                        |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | *Secondary outcome*                                                                                  |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Education (i.e., education completion and qualification or access to / in education)             |                                                                                                                                                              |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Study design** | *Experimental designs:*                                                                              | Non-primary studies, including:                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Randomised Controlled Trials (RCT) including individual RCTs and cluster RCTs                    | -   Literature reviews                                                                                                                                       |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Step-Wedge designs with random time allocation                                                   | -   Systematic reviews                                                                                                                                       |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | *Quasi-experimental designs:*                                                                        | -   Meta-analyses                                                                                                                                            |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Non-equivalent control group designs using parallel cohorts that adjust for baseline equivalence | Studies without a valid counterfactual, including designs that do not use a parallel cohort that establishes or adjusts for baseline equivalence, including: |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Difference-in-Difference estimation                                                              | -   Single group pre-post designs                                                                                                                            |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Interrupted time-series                                                                          | -   Control group designs without matching in time and establishing baseline equivalence                                                                     |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   Synthetic control group methods                                                                  | -   Cross-sectional designs                                                                                                                                  |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | Studies based on:                                                                                    | -   Non-controlled observational (cohort) designs                                                                                                            |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   covariate matching                                                                               | -   Case-control designs                                                                                                                                     |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   propensity score-based methods,                                                                  | -   Case studies / series                                                                                                                                    |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   doubly robust methods                                                                            | -   Surveys                                                                                                                                                  |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   regression adjustment                                                                            |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   regression discontinuity designs, and                                                            |                                                                                                                                                              |
|                  |                                                                                                      |                                                                                                                                                              |
|                  | -   instrumental variable estimation                                                                 |                                                                                                                                                              |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Setting**      | Studies undertaken in high income countries as defined by the [@worldbankWorldBankCountry2022].      | Studies undertaken in low or middle income countries as defined by the [@worldbankWorldBankCountry2022].                                                     |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Other**        | Studies published in English.                                                                        | Studies published in languages other than English.                                                                                                           |
+------------------+------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------+

: Inclusion and exclusion criteria {#tbl-ye-nma-inclusion-exculsion-criteria} {tbl-colwidths="\[20,40,40\]"}

# Extraction and transformation of information from relevant studies

## Data extracted from included studies

+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Category                    | Detail                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+=============================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| *Bibliographic information* | Author, title, year of publication                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| *Intervention details*      | Intervention name, relevant components (treatment), relevant components (comparison), year intervention commenced, year intervention ended, year study commenced, year study ended, Inclusion criteria, exclusion criteria, intervention length, intervention delivery mode, comparison type, comparison intervention (if relevant)                                                                                                                                                                                                                                                                                                    |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| *Setting*                   | Study location (country)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| *Population*                | Sample size, \# treatment, \# comparison, gender (% female), ethnicity, self-reported disability, elevated risk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| *Study design*              | Study design, study method                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| *Outcomes*                  | Outcome domain, outcome measure, time of measurement                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| *Results*                   | Result type, reported result (treatment), reported results (comparison), reported standard error (SE)(treatment), reported SE (comparison), reported or derived standard deviation (SD) (treatment effect or treatment), reported or derived SD (comparison), reported treatment effect (TE) type, reported TE, reported TE SE, reported TE 95 per cent confidence interval (CI) (lower), reported TE 95 per cent CI (upper), reported TE t-stat, stat. sig (p-value), reported effect size (ES) type, reported ES, reported ES 95 per cent CI (lower), reported ES 95 per cent CI (upper), reported ES t-stat, ES stat. sig (p-value) |
+-----------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

: Information extracted from included studies {#tbl-ye-nma-data-extraction-info} {tbl-colwidths="\[25,75\]"}

## Outcome selection criteria

+-----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Term                        | Definition                                                                                                                                 |
+=============================+============================================================================================================================================+
| *Ever worked*               | An individual was employed at any point, for any duration, after commencement of the intervention                                          |
+-----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| *Worked in previous period* | An individual was employed at any point, in a defined period of time prior to measurement for any duration after intervention commencement |
+-----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| *Currently working*         | An individual was employed, in any capacity, at time of measurement after intervention commencement                                        |
+-----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| *Employment probability*    | The probability an individual was employed, at any point, for any duration, after intervention commencement                                |
+-----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+

: Definitions used for outcome selection hierarchy {#tbl-ye-nma-definitions-outcome-selection} {tbl-colwidths="\[25,75\]"}

## Record of methodological decisions

+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Primary reference**                           | **Outcome**                              | **Identified Issue**                                                                                                                                                                                 | **Decision**                                                                                                                                                                                                           |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @alegreImpactTrainingintensiveLabour2015        | Employment status                        | Results for both starters (ITT) and completers (TOT) are reported                                                                                                                                    | We used the results for starters                                                                                                                                                                                       |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @alegreImpactTrainingintensiveLabour2015        | Employment status                        | Only the sample size for the treatment group was reported                                                                                                                                            | We assumed that that 1:1 matching was used and therefore the size of the control group matched the treatment group                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @alegreImpactTrainingintensiveLabour2015        | Employment status                        | Results are only reported graphically. It was possible to extract the mean difference (and confidence interval) from the reported figure.                                                            | Authors were not able to provide results, so these were extracted using a plot digitizer tool [@PlotDigitizerOnlineApp].                                                                                               |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @alegreImpactTrainingintensiveLabour2015        | Employment status                        | The information was insufficient to transform into a common effect size using functions available in the *esc* R package [@ludecke2019esceffectsize].                                                | The mean difference and confidence interval were standardised by dividing by their standard deviation (which was derived from the extracted confidence intervals).                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @bloomNationalJTPAStudy1993                     | Employment status / Education completion | Treatment and control group sample sizes are not reported, only overall sample                                                                                                                       | Treatment and control group sample sizes are estimated from the ratio reported by the authors (treatment: 2/3, control: 1/3)                                                                                           |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @brunettiWorkplaceTrainingPrograms2017          | Employment status                        | The authors report four models based on different matching specifications: stratification matching, radius matching, nearest neighbour matching, kernel matching. All of the results are similar.    | We selected the model based on kernel matching.                                                                                                                                                                        |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @centeno2008evaluatingjobsearch                 | Employment status                        | The authors report four models using different DiD specifications: unrestricted DiD, restricted DiD, DiD with PSM (kernel) matching, DiD with PSM (spline) matching. All of the results are similar. | We selected a DiD model using PSM (kernel) matching based on author preferences                                                                                                                                        |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @centeno2008evaluatingjobsearch                 | Employment status                        | The authors report inconsistent numbers of participants their summary statistics (Table 1) and model results (Table 2).                                                                              | After receiving no response from the authors to our query, we have used the numbers reported in Table 1                                                                                                                |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @caliendo2011fightingyouthunemployment          | Employment status                        | The number of observations in the control group are not reported                                                                                                                                     | Control group sample sizes are estimated from the average ratio (1:20) reported by the authors                                                                                                                         |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @caliendo2011fightingyouthunemployment          | Employment status                        | Results for different geographies (states of former East and West Germany) are reported separately                                                                                                   | These outcomes were combined by adding percentages                                                                                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @courtneyExperimentalEvaluationTransitional2019 | Education completion                     | High school completion and attainment of general education development results were reported separately                                                                                              | These outcomes were combined by adding percentages                                                                                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @degiorgiNewDealYoung2005                       | Employment status                        | Male and Female results reported separately                                                                                                                                                          | Results for Males and Females were combined in a meta-analysis to obtain a pooled effect for this program                                                                                                              |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @degiorgiNewDealYoung2005                       | Employment status                        | Treatment and Comparison group sizes are not reported                                                                                                                                                | We assumed that that 1:1 matching was used and therefore the size of the control group matched the treatment group                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @duarte2020evaluationyouthemployment            | Employment status                        | The number of observations in the control group are not reported                                                                                                                                     | We assumed that that 1:1 matching was used and therefore the size of the control group matched the treatment group                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @duarte2020evaluationyouthemployment            | Employment status                        | The impact of different lengths of on-the-job training are reported (6 months, 12 months and 18 months)                                                                                              | Results for 6 months and 12 months were combined in a meta-analysis to obtain a pooled effect for this program. Results for 18 months were excluded, as these fall outside our eligibility criteria for this component |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @ehlert2012temporaryworkactivea                 | Employment status                        | SE or SD not reported                                                                                                                                                                                | SE derived from reported information (regression coefficient and t-statistic), SD calculated from SE                                                                                                                   |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @guptaEvaluationLinkingInnovation2016           | Employment status / Education completion | It is not reported at what point in time outcomes are measured                                                                                                                                       | We have assumed 6 months                                                                                                                                                                                               |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @hamalainenVocationalLabourMarket2008           | Employment status                        | Sample size and standard errors were not reported                                                                                                                                                    | This information was provided by the authors                                                                                                                                                                           |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @hollenbeckNetImpactEstimates2006               | Employment status / Education completion | Results for 2001/02 and 2002/03 were reported separately                                                                                                                                             | These outcomes were combined by adding percentages                                                                                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @hollenbeckNetImpactBenefitCost2016             | Employment status / Education completion | Results for 2001/02 and 2002/03 were reported separately                                                                                                                                             | These outcomes were combined by adding percentages                                                                                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @maibom2014canactivelabour                      | Employment status                        | Neither the SE or SD was not reported                                                                                                                                                                | SE was derived from reported information (regression coefficient and t-statistic), subsequently the SD was derived from the SE                                                                                         |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @nadonMakingTransitionHow2020                   | Employment status                        | The two studies reported in this study, uses the same data source as @kimEstimatingEffectsIndependent2019                                                                                            | @kimEstimatingEffectsIndependent2019 selected as the primary study. @nadonMakingTransitionHow2020 was excluded from the analysis                                                                                       |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @quintNewChanceFinal1997                        | Education completion                     | High school completion and attainment of general education development results were reported separately                                                                                              | These outcomes were combined by adding percentages                                                                                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @rosholmBridgingGapWelfare2019                  | Employment status / Education completion | Results are only available graphically                                                                                                                                                               | Authors were not able to provide results, so these were extracted using a plot digitizer tool [@PlotDigitizerOnlineApp].                                                                                               |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @rosholmBridgingGapWelfare2019                  | Employment status / Education completion | Sample size for comparison group is not provided                                                                                                                                                     | We assumed that that 1:1 matching was used and therefore the size of the control group matched the treatment group                                                                                                     |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| @theodosPathwaysHighSchool2017                  | Employment status                        | The authors only reported total observations for each analysis                                                                                                                                       | Control and treatment group sizes were estimated from proportions in the treatment and control group                                                                                                                   |
+-------------------------------------------------+------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

: Details of decisions made during the transformation of effect sizes {#tbl-ye-nma-full-text-reject} {tbl-colwidths="\[20,20,30,30\]"}

# Supplementary information about included and excluded studies

+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Intervention name                                                                                      | Primary reference                               | Secondary reference(s)                    |
+========================================================================================================+=================================================+===========================================+
| Inserjovem                                                                                             | @centeno2008evaluatingjobsearch                 | @centeno2006avaliacaoimpactoum            |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Job Corps                                                                                              | @schochetDoesJobCorps2008                       | @schochetNationalJobCorps2001             |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @schochetNationalJobCorps2006             |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @zhangLikelihoodbasedAnalysisCausal2009   |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @leeTrainingWagesSample2009               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @flores-lagunesLearningNotEarning2010     |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @bampasidouUnbundlingDegreeEffect2012     |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @bampasidouRoleDegreeAttainment2014       |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @frumentoEvaluatingEffectTraining2012     |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @blancoEffectsJobCorps2013                |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @blancoBoundsAverageQuantile2013          |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @blancoDoesYouthTraining2017              |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @gritzNationalJobCorps2001                |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @chenPartialIdentificationAverage2013     |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @chenGoingLATEBounding2018                |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Job Training Partnership Act (JTPA) --- Classroom training                                             | @bloomNationalJTPAStudy1993                     | @bloomBenefitsCostsJTPA1997               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @heckmanMatchingEconometricEvaluation1997 |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @heckmanPreprogrammeEarningsDip1999       |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @kornfeldMeasuringProgramImpacts1999      |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Job Training Partnership Act (JTPA) --- OJT/JSA                                                        | @bloomNationalJTPAStudy1993                     | @bloomBenefitsCostsJTPA1997               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @heckmanMatchingEconometricEvaluation1997 |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @heckmanPreprogrammeEarningsDip1999       |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @kornfeldMeasuringProgramImpacts1999      |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Job Training Partnership Act (JTPA) --- Other services                                                 | @bloomNationalJTPAStudy1993                     | @bloomBenefitsCostsJTPA1997               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @heckmanMatchingEconometricEvaluation1997 |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @heckmanPreprogrammeEarningsDip1999       |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @kornfeldMeasuringProgramImpacts1999      |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| National Guard Youth ChalleNGe                                                                         | @millenkySupportingTransitionAdulthood2014      | @millenkyStayingCourseThreeYear2011       |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @millenkyMakingTransitionInterim2010      |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Project SEARCH, plus ASD supports                                                                      | @wehmanEffectsEmployerbasedIntervention2017     | @wehmanCompetitiveEmploymentYouth2014     |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Temporary Work ALMP                                                                                    | @ehlert2012temporaryworkactivea                 | @ehlert2012temporaryworkactive            |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Urban Alliance High School Internship Program                                                          | @theodosPathwaysHighSchool2017                  | @theodosEmbarkingCollegeCareer2016        |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Year Up, Pilot Study                                                                                   | @roder2014sustainedgainsyear                    | @roder2011promisingstartyear              |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| YouthBuild                                                                                             | @millerLayingFoundationFouryear2018             | @millerBuildingFutureInterim2016          |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Youth Transition Demonstration Evaluation, Transition WORKS, Erie County, NY                           | @frakerThreeYearEffectsYouth2018                | @frakerFinalReportYouth2014               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @frakerSocialSecurityAdministration2011   |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Youth Transition Demonstration Evaluation, Broadened Horizons, Brighter Futures, Miami-Dade County, NY | @frakerThreeYearEffectsYouth2018                | @frakerYouthTransitionDemonstration2018   |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @frakerFinalReportYouth2014               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @frakerSocialSecurityAdministration2012   |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Youth Transition Demonstration Evaluation, YTDP, Bronx NY                                              | @frakerThreeYearEffectsYouth2018                | @frakerFinalReportYouth2014               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @frakerSocialSecurityAdministration2011b  |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Youth Transition Demonstration Evaluation, Career Transition Program, Montgomery County, MD            | @frakerThreeYearEffectsYouth2018                | @frakerFinalReportYouth2014               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @fraker2012socialsecurityadministration   |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| Youth Transition Demonstration Evaluation, Youth Works, West Virginia                                  | @frakerThreeYearEffectsYouth2018                | @frakerFinalReportYouth2014               |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @frakerSocialSecurityAdministration2012a  |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+
| YVLifeSet                                                                                              | @courtneyExperimentalEvaluationTransitional2019 | @skemerStrivingIndependenceTwoyear2016    |
|                                                                                                        |                                                 |                                           |
|                                                                                                        |                                                 | @valentine2015becomingadultsoneyear       |
+--------------------------------------------------------------------------------------------------------+-------------------------------------------------+-------------------------------------------+

: Distinguishing between multiple reports of the same study {#tbl-ye-nma-multiple-reports} {tbl-colwidths="\[20,40,40\]"}

+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Intervention name                                               | Reference(s)                                   | Rationale                                                        |
+=================================================================+================================================+==================================================================+
| New Deal for Young People, Job Assistance elements              | @blundellEvaluatingEmploymentImpact2004        | Wrong Intervention --- intervention components fit under "other" |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Job Search (JS)                                                 | @caliendo2011fightingyouthunemployment         | Wrong Intervention --- intervention components fit under "other" |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Job Creation Schemes (JCS)                                      | @caliendo2011fightingyouthunemployment         | Wrong Intervention --- intervention components fit under "other" |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Young Adult Internship Program                                  | @cummingsForgingPathFinal2018                  | Wrong Intervention --- intervention components fit under "other" |
|                                                                 |                                                |                                                                  |
|                                                                 | @skemerReengagingNewYork2017                   |                                                                  |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Youth Transition Demonstration Evaluation, Youth Wins, Colorado | @frakerThreeYearEffectsYouth2018               | Wrong Intervention --- intervention components fit under "other" |
|                                                                 |                                                |                                                                  |
|                                                                 | @frakerFinalReportYouth2014                    |                                                                  |
|                                                                 |                                                |                                                                  |
|                                                                 | @frakerSocialSecurityAdministration2011a       |                                                                  |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| PIPOL, Internships                                              | @pastoreAssessingImpactOffand2019              | Wrong Intervention --- intervention components fit under "other" |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Slovenian Institutional Training Program                        | @rotarEvaluatingEffectivenessInstitutional2012 | Wrong Intervention --- intervention components fit under "other" |
|                                                                 |                                                |                                                                  |
|                                                                 | @rotarHowEffectiveSlovenian2012                |                                                                  |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+
| Independent Living, Employment Services, Kern County CA         | @zinn2017helpingfosteryouth                    | Wrong Intervention --- intervention components fit under "other" |
|                                                                 |                                                |                                                                  |
|                                                                 | @courtney2011evaluationindependentliving       |                                                                  |
+-----------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------+

: Selection of studies rejected at full-text review {#tbl-ye-nma-full-text-reject} {tbl-colwidths="\[30,40,30\]"}

+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| Primary reference                    | Intervention name                                                             | Outcome                                                            | Effect size reported or can be transformed from reported results | Reason                |
+======================================+===============================================================================+====================================================================+==================================================================+=======================+
| @bloomNationalJTPAStudy1993          | Job Training Partnership Act (JTPA) --- Classroom training                    | Hours worked at Quarter 6 (Female, Male Youth)                     | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @bloomNationalJTPAStudy1993          | Job Training Partnership Act (JTPA) --- OJT/JSA                               | Hours worked at Quarter 6 (Female, Male Youth)                     | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @bloomNationalJTPAStudy1993          | Job Training Partnership Act (JTPA) --- Other services                        | Hours worked at Quarter 6 (Female, Male Youth)                     | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @caveJOBSTARTFinalReport1993         | JOBSTART Demonstration                                                        | Total Hours worked Year 4                                          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @feinBridgingOpportunityDivide2018   | Year Up Multi-Site                                                            | Average weekly hours worked at time of 18-month follow-up survey   | Yes                                                              |                       |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @frakerThreeYearEffectsYouth2018     | Youth Transition Demonstration (YTD) --- Transition WORKS                     | Total hours worked in paid job in the last year (36-month survey)  | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @frakerThreeYearEffectsYouth2018     | Youth Transition Demonstration (YTD) --- Broadened Horizons, Brighter Futures | Total hours worked in paid job in the last year (36-month survey)  | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @frakerThreeYearEffectsYouth2018     | Youth Transition Demonstration (YTD) --- YTDP                                 | Total hours worked in paid job in the last year (36-month survey)  | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @frakerThreeYearEffectsYouth2018     | Youth Transition Demonstration (YTD) --- Career Transition Program            | Total hours worked in paid job in the last year (36-month survey)  | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @frakerThreeYearEffectsYouth2018     | Youth Transition Demonstration (YTD) --- Youth Works                          | Total hours worked in paid job in the last year (36-month survey)  | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @hollenbeckNetImpactEstimates2006    | High school career and technical education programs                           | Average quarterly hours 3 quarters following program exit          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @hollenbeckNetImpactEstimates2006    | Workforce Investment Act (Youth Program)                                      | Average quarterly hours 3 quarters following program exit          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @hollenbeckNetImpactEstimates2006    | Workforce Investment Act --- Apprenticeship Programs                          | Average quarterly hours 3 quarters following program exit          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @hollenbeckNetImpactBenefitCost2016  | High school career and technical education programs                           | Average quarterly hours 3 quarters following program exit          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @hollenbeckNetImpactBenefitCost2016  | Workforce Investment Act (Youth Program)                                      | Average quarterly hours 3 quarters following program exit          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @hollenbeckNetImpactBenefitCost2016  | High school career and technical education programs                           | Average quarterly hours 3 quarters following program exit          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @mcclanahanEnrichingSummerWork2004   | SCEP                                                                          | Average hours worked for three-month period                        | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @millerChallengeRepeatingSuccess2005 | Centre for Employment Training                                                | Number of months worked Year 1 / 2 / 3 / 4                         | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @quintNewChanceFinal1997             | New Chance                                                                    | Average hours worked 31-42 months follow-up                        | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @roder2014sustainedgainsyear         | Year Up Pilot                                                                 | Number of hours worked during the 4th year after random assignment | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @schaefferRCTPromisingVocational2014 | Community Restitution Apprenticeship-Focused Training                         | Hours worked per month                                             | Yes                                                              |                       |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @schochetDoesJobCorps2008            | Job Corps                                                                     | Average hours employed per week in Year 4                          | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+
| @wassermanEngagingYoungMen2019       | Bridges to Pathways Program                                                   | Hours worked per week (among those who were employed)              | No                                                               | SD or SE not reported |
+--------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------+------------------------------------------------------------------+-----------------------+

: Details of included studies reporting hours worked {#tbl-ye-nma-inc-studies-hours-worked} {tbl-colwidths="\[15,15,30,20,20\]"}

+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| Reference                                       | Intervention name                                                             | Outcome                                                              | Effect size reported or can be transformed from reported results | Reason                             |
+=================================================+===============================================================================+======================================================================+==================================================================+====================================+
| @bauerEvaluationNewYork2014                     | New York City Justice Corps                                                   | Average cumulative wages after 24 months                             | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @bloomNationalJTPAStudy1993                     | Job Training Partnership Act (JTPA) --- Classroom training                    | Earnings at quarter 6, Earnings over 18-month period                 | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @bloomNationalJTPAStudy1993                     | Job Training Partnership Act (JTPA) --- OJT/JSA                               | Earnings at quarter 6, Earnings over 18-month period                 | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @bloomNationalJTPAStudy1993                     | Job Training Partnership Act (JTPA) --- Other services                        | Earnings at quarter 6, Earnings over 18-month period                 | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @caveJOBSTARTFinalReport1993                    | JOBSTART Demonstration                                                        | Total earnings Years 4                                               | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @courtney2011evaluationmassachusettsadolescent  | Massachusetts Adolescent Outreach Program                                     | Earnings in the 12 months prior (\~2 years after commencement)       | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @courtneyExperimentalEvaluationTransitional2019 | YVLifeSet                                                                     | Earnings from formal work (in the year after intervention start)     | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @davisRethinkingBenefitsYouth2017               | One Summer Chicago Plus (OSC+): First RCT, 2016                               | Earnings two years after program                                     | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @davisRethinkingBenefitsYouth2017               | One Summer Chicago Plus (OSC+): Second RCT, 2018                              | Earnings two years after program                                     | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @duarte2020evaluationyouthemployment            | Youth Employment Initiative                                                   | Effect on wage in 36 months                                          | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @feinBridgingOpportunityDivide2018              | Year Up Multi-Site                                                            | Total earnings in Year 3 post-random assignment                      | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @frakerThreeYearEffectsYouth2018                | Youth Transition Demonstration (YTD) --- Transition WORKS                     | Total earnings in the past year (36-month survey)                    | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @frakerThreeYearEffectsYouth2018                | Youth Transition Demonstration (YTD) --- Broadened Horizons, Brighter Futures | Total earnings in the past year (36-month survey)                    | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @frakerThreeYearEffectsYouth2018                | Youth Transition Demonstration (YTD) --- YTDP                                 | Total earnings in the past year (36-month survey)                    | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @frakerThreeYearEffectsYouth2018                | Youth Transition Demonstration (YTD) --- Career Transition Program            | Total earnings in the past year (36-month survey)                    | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @frakerThreeYearEffectsYouth2018                | Youth Transition Demonstration (YTD) --- Youth Works                          | Total earnings in the past year (36-month survey)                    | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @geckelerHelpingDropoutYouth2017                | Los Angeles Reconnections Career Academy (LARCA)                              | Total earnings 2 years since random assignment                       | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hamalainenVocationalLabourMarket2008           | Labour Market Training                                                        | Earnings two years after program starts (SEK)                        | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hollenbeckNetImpactEstimates2006               | High school career and technical education programs                           | Average quarterly earnings 3 quarters following program exit         | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hollenbeckNetImpactEstimates2006               | Workforce Investment Act (Youth Program)                                      | Average quarterly earnings 3 quarters following program exit         | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hollenbeckNetImpactEstimates2006               | Workforce Investment Act --- Apprenticeship Programs                          | Average quarterly earnings 3 quarters following program exit         | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hollenbeckNetImpactBenefitCost2016             | High school career and technical education programs                           | Average quarterly earnings 3 quarters following program exit         | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hollenbeckNetImpactBenefitCost2016             | Workforce Investment Act (Youth Program)                                      | Average quarterly earnings 3 quarters following program exit         | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @hollenbeckNetImpactBenefitCost2016             | Workforce Investment Act --- Apprenticeship Programs                          | Average quarterly earnings 3 quarters following program exit         | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @izzoIncreasingEmploymentEarnings2000           | Extended Transition Services                                                  | Mean earnings 8 quarters (2 years) following exit from program       | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @kopecnaCounterfactualImpactEvaluation2016      | Youth Guarantee                                                               | Difference in monthly income 18 months post intervention start       | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @mcclanahanEnrichingSummerWork2004              | SCEP                                                                          | Average earnings for three-month period                              | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @millenkySupportingTransitionAdulthood2014      | National Guard Youth ChalleNGe                                                | Earnings in last 12 months (36 months following program start)       | Yes                                                              |                                    |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @millerLayingFoundationFouryear2018             | YouthBuild                                                                    | Earnings in year four since randomisation                            | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @millerChallengeRepeatingSuccess2005            | Centre for Employment Training                                                | Total earnings during 54 month follow up (\$)                        | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @priceNationalEvaluationYouth2011               | Youth Corps                                                                   | Total personal income in last year (18-month follow up)              | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @quintNewChanceFinal1997                        | New Chance                                                                    | Average total earnings 31-42 months follow-up                        | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @roder2014sustainedgainsyear                    | Year Up Pilot                                                                 | Earnings during the 4th year after random assignment                 | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @schochetDoesJobCorps2008                       | Job Corps                                                                     | Average earnings per week by Year 4                                  | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @strombackEarningsSchoolingVocational2010       | Vocational education and training                                             | Log weekly earnings (full-time only), wave 10 (approx. 23 years old) | No                                                               | SD, SE or sample size not reported |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @theodosPathwaysHighSchool2017                  | Urban Alliance Program                                                        | Post program wages (24-month survey)                                 | Yes                                                              | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @wassermanEngagingYoungMen2019                  | Bridges to Pathways Program                                                   | Hourly wage (mean)                                                   | No                                                               | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+
| @wehmanEffectsEmployerbasedIntervention2017     | Project SEARCH Plus ASD Support                                               | Wages (change from baseline to 12 months post-graduation)            | Yes                                                              | SD or SE not reported              |
+-------------------------------------------------+-------------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------+------------------------------------+

: Details of included studies reporting wages or earnings {#tbl-ye-nma-inc-studies-wages} {tbl-colwidths="\[15,15,30,20,20\]"}

+-------------------------------------+-----------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| Reference                           | Intervention name           | Outcome                                                                               | Effect size reported or can be transformed from reported results | Reason                                                         |
+=====================================+=============================+=======================================================================================+==================================================================+================================================================+
| @bauerEvaluationNewYork2014         | New York City Justice Corps | Obtained technical training certificate or license (at 12 month follow up)            | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-----------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| @millerLayingFoundationFouryear2018 | YouthBuild                  | Received a trade licence or training certificate within 12 months after program start | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-----------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| @quintNewChanceFinal1997            | New Chance                  | Received trade license by end of month 6 / 18 / 30 / 42                               | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-----------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| @schochetDoesJobCorps2008           | Job Corps                   | Attained vocational, technical or trade certificate during 48-month period            | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-----------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| @wassermanEngagingYoungMen2019      | Bridges to Pathways Program | Earned professional license or certification (within 12 months)                       | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-----------------------------+---------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+

: Details of included studies reporting vocational education commencement {#tbl-ye-nma-inc-studies-vocational-ed} {tbl-colwidths="\[15,15,30,20,20\]"}

+-------------------------------------+-------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| Reference                           | Intervention name | Outcome                                                                                                                       | Effect size reported or can be transformed from reported results | Reason                                                         |
+=====================================+===================+===============================================================================================================================+==================================================================+================================================================+
| @schochetDoesJobCorps2008           | Job Corps         | Attained college degree during 48 month period                                                                                | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| @millerLayingFoundationFouryear2018 | YouthBuild        | Received a post-secondary degree / Associate's degree / Bachelor's degree / other degree within 12 months after program start | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+
| @priceNationalEvaluationYouth2011   | Youth Corps       | Associate's degree or above / Bachelor's degree or above / Graduate degree within 30 month                                    | No                                                               | Not attempted, insufficient studies for quantitative synthesis |
+-------------------------------------+-------------------+-------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------------------------------------+

: Details of included studies reporting university commencement {#tbl-ye-nma-inc-studies-university} {tbl-colwidths="\[15,15,30,20,20\]"}

# Quantitative synthesis

```{r}
#| echo: false
#| message: false
#| name: nma-data
#| label: nma-data
#| cache: true

# load data
employment_component_es_data_location <- "../network-meta/nma/meta-data/employment_analysis_data.RDS"
employment_component_es_data <- readRDS(employment_component_es_data_location)

education_component_es_data_location <- "../network-meta/nma/meta-data/education_analysis_data.RDS"
education_component_es_data <- readRDS(education_component_es_data_location)
```

## Employment status

### Fit standard NMA

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-standard-nma
#| fig-cap: Forest plot depicting results of a standard NMA for employment status
#| fig-width: 10
#| fig-height: 4
#| label: fig-nma-employment-status-standard-nma
#| cache: true

# specify nma
employment_network_meta_random_effects <- netmeta(
  TE = es,
  seTE = se,
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study,
  data = employment_component_es_data, 
  reference.group = "SAU",
  sm = "SMD", 
  nchar.trts = 30,
  common = FALSE,
  drop.reference.group = TRUE)

# define labels
component_combination_labels <- c(
  "On-the-job Training + Other",
  "Basic Skills + Off-the-job Training + Other",
  "On-the-job Training",
  "Apprenticeships",
  "Life Skills + Coaching & Mentoring + Other",
  "Off-the-job Training",
  "Basic Skills + Life Skills + Off-the-job Training + Other",
  "Life Skills + Off-the-job Training + Other",
  "Basic Skills + Life Skills + Coaching & Mentoring + Other",
  "Basic Skills",
  "Off-the-job Training + On-the-job Training + Other",
  "Coaching & Mentoring + Other",
  "Basic Skills + Life Skills + Other",
  "Other",
  "Basic Skills + Coaching & Mentoring + Other",
  "Basic Skills + Life Skills + Off-the-job Training + Coaching & Mentoring + Other",
  "Life Skills + Other",
  "Basic Skills + Off-the-job Training",
  "Basic Skills + Other"
  )

# plot results
forest(employment_network_meta_random_effects,
   studlab = component_combination_labels,     
   reference.group = "SAU",
   col.by = "black",
   xlim = c(-1, 1.5),
   addrow.subgroups = FALSE,
   fontsize = 10, 
   spacing = 0.7,
   leftcols = c("studlab", "prop.direct"),
   equal.size = FALSE,
   sortvar = -"TE",
   label.left = "Favours Usual Services",
   label.right = "Favours Intervention",
   drop.reference.group = TRUE)
```

### Visualise the network structure

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-structure
#| fig-cap: Network map for employment status NMA
#| fig-width: 15
#| fig-height: 10
#| label: fig-nma-employment-status-structure
#| crop: true
#| cache: true

# visualise network structure 
set.seed(268)

network_labels <- c(
  "Apprenticeships",                  
  "Basic Skills",                   
  "Basic Skills + Coaching & Mentoring + Other",           
  "Basic Skills + Life Skills + Coaching & Mentoring + Other",        
  "Basic Skills + Life Skills + Off-the-job Training + Coaching & Mentoring + Other", 
  "Basic Skills + Life Skills + Off-the-job Training + Other",    
  "Basic Skills + Life Skills + Other",            
  "Basic Skills + Off-the-job Training",            
  "Basic Skills + Off-the-job Training + Other",        
  "Basic Skills + Other",               
  "Coaching & Mentoring + Other",              
  "Life Skills + Coaching & Mentoring + Other",          
  "Life Skills + Off-the-job Training + Other",        
  "Life Skills + Other",               
  "Off-the-job Training",               
  "Off-the-job Training + On-the-job Training + Other",     
  "On-the-job Training",                
  "On-the-job Training + Other",           
  "Other",                  
  "Services as usual")

# produce plot
netgraph(
  employment_network_meta_random_effects,
  plastic = FALSE,
  col = "#E06632",
  number.of.studies = TRUE,
  cex = 0.75,
  cex.num = 0.9,
  pos.number.of.studies = 0.7,
  labels = network_labels)
```

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-comp-vis
#| fig-cap: Heatmap showing the distribution of components among included studies for employment status
#| fig-width: 10
#| fig-align: 'left'
#| out.width: '75%'
#| dpi: 300 
#| label: fig-nma-employment-status-comp-vis
#| cache: true
#| crop: true

# visualise components included in NMA
employment_nma_component_visualisation <- compdesc(
  model = employment_network_meta_random_effects,
  sep = "+",
  digits = 0) 

employment_nma_component_visualisation$heatmat +
  theme_minimal(base_size = 12) +
  theme(
    plot.background = element_rect(
      fill = "white",
      colour = "white"),
    legend.position = "bottom",
    legend.direction = "horizontal"
  )
```

::: custom-footnote
**Plot Legend:**\
*BS:* Basic Skills, *LS:* Life Skills, *OFF-JT:* Off-the-job training, *ON-JT:* On-the-job-training, *APP:* Apprenticeships, *C&M:* Coaching and mentoring, *OTH:* Other (residual) component.
:::

### Summary results in league table

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-netleague
#| tbl-cap: Relative effects of combinations of components of employment and skills programs on employment status
#| label: tbl-nma-employment-status-netleague
#| cache: true
#| crop: true

# calculate netleague table
employment_status_league <- netleague(
  x = employment_network_meta_random_effects,
  direct = TRUE,
  digits = 2,
  overwrite = TRUE)

# extract random effects results
league_table_matrix <- employment_status_league$random

# convert the matrix to a data frame
league_employment_status_table_data_frame <- as.data.frame(league_table_matrix)

# declare function to wrap results
wrap_nma_results <- function(df) {
  # apply function
  df[] <- lapply(df, function(x) {
    # test if cell contains a square bracket (indication 95% CI result) and if so, apply function
    x <- ifelse(str_detect(x, "\\["), 
                str_replace(x, "\\s\\[", "\n["), # adds a new line before "["
                x)
    x <- str_replace(x, ";\\s", ";") # removes the space after ";" produced by the netleague() output
    x
  })
  
  return(df)
}

# declare function to insert a new line at the nearest "+"
insert_newline <- function(text, wrap_length) {
  # ensure text is character
  text <- as.character(text)
  
  # initialise output vector
  output <- character(length(text))
  
  for (i in seq_along(text)) {
    current_text <- text[i]
    if (str_detect(current_text, "\\+")) {
      plus_positions <- str_locate_all(current_text, "\\+")
      # check if plus_positions is not empty
      if (length(plus_positions[[1]]) > 0) {
        # extract positions of all "+" symbols
        start_positions <- plus_positions[[1]][,1]
        # find the nearest "+" before the wrap_length, if any
        target_position <- max(start_positions[start_positions < wrap_length], na.rm = TRUE)
        if (!is.na(target_position) && target_position > 0) {
          current_text <- substr(current_text, 1, target_position) %>% 
                          paste0("\n", substr(current_text, target_position + 1, nchar(current_text)))
        }
      }
    }
    output[i] <- current_text
  }
  
  return(output)
}

# declare function to wrap label
wrap_component_labels <- function(df, wrap_length) {
  df[] <- lapply(df, function(x) insert_newline(x, wrap_length))
  return(df)
}

# declare function to colour label cells
colour_labels <- function(df, colour, text_colour) {
  # apply specification to label cells
  for (i in 1:min(nrow(df), ncol(df))) {
    df[i, i] <- cell_spec(
      df[i, i], 
      background = colour, 
      color = text_colour,
      extra_css = 
        "margin: -8px; 
        padding: 8px; 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        font-weight: bold; 
        min-height: 60px;"
    )
  }
  df
}

# declare function to colour cells in upper matrix
colour_upper_matrix <- function(df, colour, text_colour) {
  # get dimensions
  n_rows <- nrow(df)
  n_cols <- ncol(df)
  # apply specification to cells in upper matrix
  for (row in 1:(n_rows - 1)) {
    for (col in (row + 1):n_cols) {
      df[row, col] <- cell_spec(
        df[row, col], 
        background = colour, 
        color = text_colour,
        extra_css = 
          "margin: -8px; 
          padding: 8px; 
          display: flex; 
          justify-content: center; 
          align-items: center; 
          min-height: 60px;"
      )
    }
  }
  df
}

# declare function to format cells in lower matrix
colour_lower_matrix <- function(df, colour, text_colour) {
  # get dimensions
  n_rows <- nrow(df)
  n_cols <- ncol(df)
  
  # apply specification to cells in lower matrix
  for (row in 2:n_rows) {
    for (col in 1:(row - 1)) {
      df[row, col] <- cell_spec(
        df[row, col], 
        background = colour, 
        color = text_colour,
        extra_css = 
          "margin: -8px; 
          padding: 8px; 
          display: flex; 
          justify-content: center; 
          align-items: center;
          min-height: 60px;"
      )
    }
  }
  df
  }

# set column names to NULL
colnames(league_employment_status_table_data_frame) <- NULL

# apply custom functions
formatted_league_employment_status_table_data_frame <- league_employment_status_table_data_frame %>%
  wrap_nma_results() %>%
  wrap_component_labels(10) %>%
  colour_labels("#E06632", "black") %>%
  colour_upper_matrix("#D1E8FF", "black") %>%
  colour_lower_matrix("#F0F0F0", "black")

# produce table
formatted_league_employment_status_table_data_frame %>%
  kable(
    "html", 
    escape = FALSE,
    align = "c"
  ) %>%
  kable_styling(
    full_width = FALSE
  ) %>%
  scroll_box(
      width = "100%", height = "1175px") %>%
  column_spec(
    1:20, 
    width_min = "10em")
```

::: custom-footnote
**Notes:**\
Effect sizes (Hedge's g) are reported with 95% confidence intervals.\
Combinations of components (listed in alphabetical order) from included studies are shown in orange.\
Direct evidence (i.e., sourced from pairwise comparisons) are shown in blue.\
Indirect effects (i.e., from the NMA) are shown in gray.\
**Legend:**\
*BS:* Basic Skills, *LS:* Life Skills, *OFF-JT:* Off-the-job training, *ON-JT:* On-the-job-training, *APP:* Apprenticeships, *C&M:* Coaching and mentoring, *OTH:* Other (residual) component.
:::

### Fit additive component NMA

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-additive
#| fig-cap: Forest plot showing the results of an additive CNMA for employment status
#| fig-height: 2.5
#| label: fig-nma-employment-status-additive
#| cache: true
#| crop: true

employment_additive_component_network_meta <- netmeta::netcomb(
  x = employment_network_meta_random_effects, 
  inactive = "SAU",
  sep.comps = "+",
  random = TRUE)

employment_additive_component_network_meta_plot_data <- netcomplex(
  employment_additive_component_network_meta,  
  employment_additive_component_network_meta$comps)

component_labels <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other")

forest(
  employment_additive_component_network_meta_plot_data,
  studlab = component_labels,
  reference.group = "SAU",
  col.by = "black",
  xlim = c(-0.5, 1),
  addrow.subgroups = FALSE,
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9,
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n",                   "(Employment status)"),
  label.left = "Favours Usual Services",
  label.right = "Favours Intervention",
  drop.reference.group = TRUE,
  leftlabs = "Intervention component",
  sortvar = -employment_additive_component_network_meta_plot_data$Comb.random
  )
```

### Fit interactive component NMAs

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-interaction-bs-ofjt
#| fig-cap: Forest plot depicting results of CNMA with interaction between Basic Skills x Off-the-job training for employment status
#| fig-height: 2.5
#| label: fig-nma-employment-status-interaction-bs-ofjt
#| cache: true
#| crop: true

employment_interaction_matrix_bs_ofjt <- cbind(
  employment_additive_component_network_meta$C.matrix, 
  `BS+OFF-JT` = 0) 
employment_interaction_matrix_bs_ofjt["BS+OFF-JT", "BS+OFF-JT"] <- 1

employment_interaction_component_network_meta_bs_ofjt <- netcomb(
  employment_network_meta_random_effects, 
  C.matrix = employment_interaction_matrix_bs_ofjt, 
  inactive = "SAU")

employment_interaction_component_network_meta_bs_ofjt_plot_data <- netcomplex(
  employment_interaction_component_network_meta_bs_ofjt,
  employment_interaction_component_network_meta_bs_ofjt$comps)

component_labels <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Basic Skills x Off-the-job Training"
  )

forest(
  employment_interaction_component_network_meta_bs_ofjt_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(Employment status)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -employment_interaction_component_network_meta_bs_ofjt_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-interaction-ojt-oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between On-the-job training x Other for employment status
#| fig-height: 2.5
#| label: fig-nma-employment-status-interaction-ojt-oth
#| cache: true
#| crop: true

employment_interaction_matrix_ojt_oth <- cbind(
  employment_additive_component_network_meta$C.matrix, 
  `ON-JT+OTH` = 0)
employment_interaction_matrix_ojt_oth["ON-JT+OTH", "ON-JT+OTH"] <- 1

employment_interaction_component_network_meta_ojt_oth <- netcomb(
  employment_network_meta_random_effects, 
  C.matrix = employment_interaction_matrix_ojt_oth, 
  inactive = "SAU")

employment_interaction_component_network_meta_ojt_oth_plot_data <- netcomplex( 
  employment_interaction_component_network_meta_ojt_oth,
  employment_interaction_component_network_meta_ojt_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "On-the-job Training x Other"
  )

forest(
  employment_interaction_component_network_meta_ojt_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(Employment status)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -employment_interaction_component_network_meta_ojt_oth_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-interaction-bs-oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between Basic Skills x Other for employment status
#| fig-height: 2.5
#| label: fig-nma-employment-status-interaction-bs-oth
#| cache: true
#| crop: true

employment_interaction_matrix_bs_oth <- cbind(
  employment_additive_component_network_meta$C.matrix,
  `BS+OTH` = 0) 
employment_interaction_matrix_bs_oth["BS+OTH", "BS+OTH"] <- 1

employment_interaction_component_network_meta_bs_oth <- netcomb(
  employment_network_meta_random_effects,
  C.matrix = employment_interaction_matrix_bs_oth, 
  inactive = "SAU")

employment_interaction_component_network_meta_bs_oth_plot_data <- netcomplex(
  employment_interaction_component_network_meta_bs_oth,
  employment_interaction_component_network_meta_bs_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Basic Skills x Other"
  )

forest(
  employment_interaction_component_network_meta_bs_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(Employment status)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -employment_interaction_component_network_meta_bs_oth_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-interaction-ls-oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between Life Skills x Other for employment status
#| fig-height: 2.5
#| label: fig-nma-employment-status-interaction-ls-oth
#| cache: true
#| crop: true

employment_interaction_matrix_ls_oth <- cbind(
  employment_additive_component_network_meta$C.matrix, 
  `LS+OTH` = 0) 
employment_interaction_matrix_ls_oth["LS+OTH", "LS+OTH"] <- 1

employment_interaction_component_network_meta_ls_oth <- netcomb(
  employment_network_meta_random_effects, 
  C.matrix = employment_interaction_matrix_ls_oth, 
  inactive = "SAU")

employment_interaction_component_network_meta_ls_oth_plot_data <- netcomplex(
  employment_interaction_component_network_meta_ls_oth,
  employment_interaction_component_network_meta_ls_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Life Skills x Other"
  )

forest(
  employment_interaction_component_network_meta_ls_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(Employment status)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -employment_interaction_component_network_meta_ls_oth_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-interaction_cm_oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between Coaching & Mentoring x Other for employment status
#| fig-height: 2.5
#| label: fig-nma-employment-status-interaction_cm_oth
#| cache: true
#| crop: true

employment_interaction_matrix_cm_oth <- cbind(
  employment_additive_component_network_meta$C.matrix, 
  `C&M+OTH` = 0) 
employment_interaction_matrix_cm_oth["C&M+OTH", "C&M+OTH"] <- 1

employment_interaction_component_network_meta_cm_oth <- netcomb( 
  employment_network_meta_random_effects, 
  C.matrix = employment_interaction_matrix_cm_oth, 
  inactive = "SAU")

employment_interaction_component_network_meta_cm_oth_plot_data <- netcomplex(
  employment_interaction_component_network_meta_cm_oth,
  employment_interaction_component_network_meta_cm_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Coaching & Mentoring x Other"
  )

forest(
  employment_interaction_component_network_meta_cm_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(Employment status)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -employment_interaction_component_network_meta_cm_oth_plot_data$Comb.random
  )
```

### Compare different NMA specifications

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-nma-comparison
#| fig-cap: Forest plot depicting results of Interaction, Additive and standard NMA of component combinations on employment status
#| fig-height: 23
#| label: fig-nma-employment-status-nma-comparison
#| cache: true
#| crop: true

# prep colour palette
colour_palette <- viridis_pal(
    begin = 0, 
    end = 0.8,
    direction = 1,
    option = "inferno"
  )(7)

# prepare plot data
employment_forest_plot_data <- netbind(
  random = TRUE, 
  common = FALSE, 
  employment_network_meta_random_effects, 
  employment_additive_component_network_meta, 
  employment_interaction_component_network_meta_bs_ofjt,
  employment_interaction_component_network_meta_ojt_oth,
  employment_interaction_component_network_meta_bs_oth,
  employment_interaction_component_network_meta_ls_oth,
  employment_interaction_component_network_meta_cm_oth,
  name = c(
    "Standard NMA", 
    "Additive cNMA", 
    "Basic Skills x Off-the-job training Interaction cNMA",
    "On-the-job training x Other Interaction cNMA",
    "Basic Skills x Other Interaction cNMA",
    "Life Skills x Other Interaction cNMA",
    "Coaching & Mentoring x Other Interaction cNMA"
    ), 
  col.study = colour_palette, 
  col.square = colour_palette
  )

# plot different nma specifications
forest(
  employment_forest_plot_data, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.75, 1.25), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Employment Program Components vs. Usual Services \n", "(Employment status)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  drop.reference.group = TRUE
  )
```

### Assess publication bias

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-pub-bias
#| fig-cap: Comparison-adjusted funnel plot for employment status
#| label: fig-nma-employment-status-pub-bias
#| fig-height: 6
#| cache: true
#| crop: true

order = c("SAU")

funnel(
  x = employment_network_meta_random_effects,
  order = order,
  pooled = "random",
  lump.comparator = TRUE,
  text.comparator = "SAU",
  pch = c(8:24), 
  col = c(8:24),
  text.linreg = "(Egger)",
  method.bias = c("Egger"), digits.pval = 2)

# prepare input for eggers test 
# input_eggers <- funnel(
#   x = employment_network_meta_random_effects,
#   order = order,
#   pooled = "random",
#   lump.comparator = TRUE,
#   text.comparator = "SAU")

# run eggers test
# metabias(metagen(TE.adj, seTE, data = input_eggers))
```

::: custom-footnote
**Plot Legend:**\
*APP:* Apprenticeships, *BS:* Basic Skills, *LS:* Life Skills, *OFF-JT:* Off-the-job training, *ON-JT:* On-the-job-training, *C&M:* Coaching and mentoring, *OTH:* Other (residual) component.
:::

### Evaluate incoherence

#### Assessing local incoherence

Application of the SIDE method to the review team's preferred specification for employment status --- visualised in @fig-nma-employment-status-incoherence-side --- allows for the exploration of inconsistency within each combination of components where mixed evidence is present.

The analysis established that there are 190 possible combinations of components in this specification. Of those combinations, twelve (n=12) solely use direct evidence. Another eleven (n=11) use mixed evidence i.e., a combination of direct and indirect evidence.

Note that the number of studies for each combination of components using mixed evidence is very small --- there are only five combinations of components that use two or more studies --- as a result, care needs to be taken into drawing conclusions from any observed inconsistency.

Application of the SIDE method identified a moderate amount of overall heterogeneity ($\tau$ = 0.180). Inconsistency between indirect and direct evidence was assessed using I^2^. Inconsistency appears to be present in three combinations, as indicated by an I^2^ value of 80 or more:

-   Life Skills + Coaching & Mentoring + Other versus Services as Usual (I^2^: 98%)

-   Off-the-job Training versus Services as Usual (I^2^: 97%)

-   Off-the-job Training + On-the-job Training + Other versus Services as Usual (I^2^: 88%)

In interpreting these results its important to note that I^2^ is a relative --- as opposed to absolute --- measure of heterogeneity @borenstein2017basicsmetaanalysisnot. Therefore taken together, these results suggest that of the moderate amount of heterogeneity that was identified, most it is true heterogeneity.

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-incoherence-side
#| fig-cap: Forest plot visualising inconsistency within the network for employment status
#| label: fig-nma-employment-status-incoherence-side
#| fig-width: 9
#| fig-height: 12
#| cache: true
#| crop: true

# implement node splitting
employment_network_meta_random_effects_node_split <- netsplit(
  employment_network_meta_random_effects) 

# produce forest plot
forest(
  employment_network_meta_random_effects_node_split,
  sortvar = -employment_network_meta_random_effects_node_split$k,
  show = "both", # only show combinations with both direct and indirect evidence,
  leftlabs = c("Component \ncombinations", "Number \nof Studies", "Prop. direct\n evidence", "I\n squared")
  )
```

#### Assessing global incoherence

The 'between designs' decomposition of Cochran's Q for employment status is presented in @tbl-nma-employment-status-incoherence-decomp below. The results suggest that the level of heterogeneity within the included designs (i.e., combinations of components) is not significant. However, caution should be taken in the interpretation of these results as the number of included studies with mixed evidence is low.

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-incoherence-decomp
#| tbl-cap: Cochran's Q for employment status
#| label: tbl-nma-employment-status-incoherence-decomp
#| cache: true
#| crop: true

# run decomposition
employment_network_meta_random_effects_decomp <- decomp.design(employment_network_meta_random_effects)

# output data to table
employment_network_meta_random_effects_decomp$Q.inc.random %>% 
  rownames_to_column() %>% 
  mutate(
    Q = round(Q, 3), 
    pval = round(pval, 3), 
    tau.within = round(tau.within, 3)) %>% 
  rename(
    Specification = rowname, 
    `p-value` = pval, 
    `Square-root of between study variance` = tau.within) %>%
  kable()
```

### Subgroup analysis

#### Study confidence

Among studies that reported employment status outcomes, sixteen (n=16) were assessed as 'high confidence', and forty-five (n=45) were 'low' or 'medium confidence'.

@fig-nma-employment-status-subgroup-study-confidence presents this analysis. There were no significant differences between the two groups. While off-the-job training for low to medium confidence studies appears significant, this is most likely to be the result of a reduction in statistical power due to the relatively small number of studies considered 'high confidence'.

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-subgroup-study-confidence
#| fig-cap: Forest plot depicting the result of subgroup analysis for employment status by study confidence
#| fig-subcap: 
#|   - "Studies in which we have low or medium confidence"
#|   - "Studies in which we have high confidence"
#| fig-height: 2
#| label: fig-nma-employment-status-subgroup-study-confidence
#| cache: true
#| layout-ncol: 1
#| crop: true

# subset data by study design
employment_network_meta_random_effects_high_confidence_data <- employment_component_es_data %>% 
  filter(study_quality == "High confidence")

employment_network_meta_random_effects_low_med_confidence_data <- employment_component_es_data %>% 
  mutate(
    relevant_studies = case_when(
      str_detect(study_quality, "Low confidence") ~ "Low or Medium confidence", 
      str_detect(study_quality, "Medium confidence") ~ "Low or Medium confidence") 
  ) %>% 
  filter(
    relevant_studies == "Low or Medium confidence"
  )

# specify standard NMA for each subgroup
employment_network_meta_random_effects_subgroup_high_confidence <- netmeta( 
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_high_confidence_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE)

employment_network_meta_random_effects_subgroup_low_med_confidence <- netmeta(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_low_med_confidence_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE,
  drop.reference.group = TRUE)

# specify additive NMA for each subgroup
employment_additive_component_network_meta_subgroup_high_confidence <- netcomb(
  x = employment_network_meta_random_effects_subgroup_high_confidence, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_subgroup_low_med_confidence <- netcomb(
  x = employment_network_meta_random_effects_subgroup_low_med_confidence, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_subgroup_high_confidence_plot_data <- netcomplex(
  employment_additive_component_network_meta_subgroup_high_confidence,
  employment_additive_component_network_meta_subgroup_high_confidence$comps)

employment_additive_component_network_meta_subgroup_low_med_confidence_plot_data <- netcomplex(
  employment_additive_component_network_meta_subgroup_low_med_confidence,
  employment_additive_component_network_meta_subgroup_low_med_confidence$comps)

# visualise results
component_labels_low_med_confidence <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_subgroup_low_med_confidence_plot_data, 
  studlab = component_labels_low_med_confidence, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.75, 1.25), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Studies in which we have \nlow or medium confidence"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -employment_additive_component_network_meta_subgroup_low_med_confidence_plot_data$Comb.random
  )

component_labels_high_confidence <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_subgroup_high_confidence_plot_data, 
  studlab = component_labels_high_confidence, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.75, 1.25), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9,
  smlab = "",
  #smlab = paste("Studies in which we have high confidence"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -employment_additive_component_network_meta_subgroup_high_confidence_plot_data$Comb.random
  )
```

#### Study location

Of the fifty-five (n=55) included studies that report employment status outcomes, thirty-six (n=36) were conducted in the United States, with the remaining nineteen (n=19) conducted elsewhere.

The results --- presented in @fig-nma-employment-status-subgroup-study-location below --- indicate that apprenticeships have a small but significant impact on employment, however they have only been evaluated in the United States. Therefore, it is unclear whether these findings are generalisable to other countries.

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-subgroup-study-location
#| fig-cap: Forest plot depicting the result of subgroup analysis for employment status by study location
#| fig-subcap: 
#|   - "Studies conducted in the United States"
#|   - "Studies conducted in other locations"
#| fig-height: 2
#| label: fig-nma-employment-status-subgroup-study-location
#| cache: true
#| layout-ncol: 1
#| crop: true

# subset data by study location
employment_network_meta_random_effects_location_usa_data <- employment_component_es_data %>% 
  filter(study_location == "United States")

employment_network_meta_random_effects_location_other_data <- employment_component_es_data %>% 
  filter(!study_location == "United States")

# specify standard NMA for each subgroup
employment_network_meta_random_effects_subgroup_location_usa <- netmeta( 
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_location_usa_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE
  )

employment_network_meta_random_effects_subgroup_location_other <- netmeta(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_location_other_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE
  )

# specify additive NMA for each subgroup
employment_additive_component_network_meta_subgroup_location_usa <- netcomb(
  x = employment_network_meta_random_effects_subgroup_location_usa, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_subgroup_location_other <- netcomb( 
  x = employment_network_meta_random_effects_subgroup_location_other, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_subgroup_location_usa_plot_data <- netcomplex( 
  employment_additive_component_network_meta_subgroup_location_usa,
  employment_additive_component_network_meta_subgroup_location_usa$comps)

employment_additive_component_network_meta_subgroup_location_other_plot_data <- netcomplex( 
  employment_additive_component_network_meta_subgroup_location_other,
  employment_additive_component_network_meta_subgroup_location_other$comps)

# visualise results
component_labels_usa <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_subgroup_location_usa_plot_data, 
  studlab = component_labels_usa, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.75, 1.25), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9,
  smlab = "",
  #smlab = paste("Studies conducted in the United States"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -employment_additive_component_network_meta_subgroup_location_usa_plot_data$Comb.random
  )

component_labels_row <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other")

forest(
  employment_additive_component_network_meta_subgroup_location_other_plot_data, 
  studlab = component_labels_row, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.75, 1.25), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Studies conducted in other locations"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -employment_additive_component_network_meta_subgroup_location_other_plot_data$Comb.random
  )
```

#### Study population

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-subgroup-study-population
#| fig-cap: Forest plot depicting the result of subgroup analysis for employment status by study population
#| fig-subcap: 
#|   - "Studies involving young people\nwith reported additional barriers"
#|   - "Studies involving young people\nwithout reported additional barriers"
#| fig-height: 2
#| label: fig-nma-employment-status-subgroup-study-population
#| cache: true
#| layout-ncol: 1
#| crop: true

# subset data by study population
employment_network_meta_random_effects_population_complex_needs_data <- employment_component_es_data %>% 
  filter(complex_population == "Yes")

employment_network_meta_random_effects_population_without_complex_needs_data <- employment_component_es_data %>%
  filter(complex_population == "No")

# specify standard NMA for each subgroup
employment_network_meta_random_effects_population_without_complex_needs <- netmeta(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_population_without_complex_needs_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE
  )

# specify additive NMA for each subgroup
employment_additive_component_network_meta_population_complex_needs <- discomb(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_population_complex_needs_data, 
  inactive = "SAU", 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE)

employment_additive_component_network_meta_population_without_complex_needs <- netcomb(
  x = employment_network_meta_random_effects_population_without_complex_needs, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_population_complex_needs_plot_data <- netcomplex(
  employment_additive_component_network_meta_population_complex_needs,
  employment_additive_component_network_meta_population_complex_needs$comps)

employment_additive_component_network_meta_population_without_complex_needs_plot_data <- netcomplex(
  employment_additive_component_network_meta_population_without_complex_needs,
  employment_additive_component_network_meta_population_without_complex_needs$comps)

# visualise results
component_labels_barriers <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_population_complex_needs_plot_data, 
  studlab = component_labels_barriers, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.5, 2.5), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Studies involving young people\nwith reported additional barriers"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -employment_additive_component_network_meta_population_complex_needs_plot_data$Comb.random)

component_labels_no_barriers <- c(
  "Apprenticeships",
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_population_without_complex_needs_plot_data, 
  studlab = component_labels_no_barriers, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.5, 2.5), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Studies involving young people\nwithout reported additional barriers"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -employment_additive_component_network_meta_population_without_complex_needs_plot_data$Comb.random)
```

### Sensitivity analysis

Thirty (n=30) of the fifty-five (n=55) included studies that report employment status outcomes used randomised study designs, while the remaining twenty-five (n=25) used non-randomised designs.

The results of this analysis --- presented below in @fig-nma-employment-status-sensitivity-analysis --- suggest that the observed overall positive effect of off-the-job training in the additive CNMA may be driven by the larger observed effect sizes in non-randomised studies. The absence of a statistically significant positive effect among randomised studies may be a result of a lack of statistical power --- there are fewer randomised than non-randomised studies --- it may also reflect a more accurate estimate of effect (i.e., the true effect is that off-the-job training has no impact on employment status) from studies that use designs which generally provide a higher level of confidence.

```{r}
#| echo: false
#| message: false
#| name: nma-employment-status-sensitivity-analysis
#| fig-cap: Forest plot depicting the result of sensitivity analysis for employment status by study design
#| fig-subcap: 
#|   - "Randomised studies"
#|   - "Non-randomised studies"
#| fig-height: 2
#| label: fig-nma-employment-status-sensitivity-analysis
#| cache: true
#| layout-ncol: 1
#| crop: true

# subset data by study design
employment_network_meta_random_effects_randomised_data <- employment_component_es_data %>% 
  filter(study_design == "Randomised")

employment_network_meta_random_effects_non_randomised_data <- employment_component_es_data %>% 
  filter(study_design == "Non-randomised")

# specify standard NMA for each subgroup
employment_network_meta_random_effects_subgroup_randomised <- netmeta(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_randomised_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE)

employment_network_meta_random_effects_subgroup_non_randomised <- netmeta(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = employment_network_meta_random_effects_non_randomised_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE)

# specify additive NMA for each subgroup
employment_additive_component_network_meta_subgroup_randomised <- netcomb(
  x = employment_network_meta_random_effects_subgroup_randomised, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_subgroup_non_randomised <- netcomb(
  x = employment_network_meta_random_effects_subgroup_non_randomised, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

employment_additive_component_network_meta_subgroup_randomised_plot_data <- netcomplex(
  employment_additive_component_network_meta_subgroup_randomised,
  employment_additive_component_network_meta_subgroup_randomised$comps)

employment_additive_component_network_meta_subgroup_non_randomised_plot_data <- netcomplex(
  employment_additive_component_network_meta_subgroup_non_randomised,
  employment_additive_component_network_meta_subgroup_non_randomised$comps)

# visualise results
component_labels_randomised <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_subgroup_randomised_plot_data, 
  studlab = component_labels_randomised, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Randomised studies"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  drop.reference.group = TRUE, 
  sortvar = -employment_additive_component_network_meta_subgroup_randomised_plot_data$Comb.random
  )

component_labels_non_randomised <- c(
  "Apprenticeships", 
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  employment_additive_component_network_meta_subgroup_non_randomised_plot_data, 
  studlab = component_labels_non_randomised, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Non-randomised studies"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  drop.reference.group = TRUE, 
  sortvar = -employment_additive_component_network_meta_subgroup_non_randomised_plot_data$Comb.random
  )
```

## Education completion

### Fit standard NMA

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-standard-nma
#| fig-cap: Forest plot depicting results of a standard NMA for education completion
#| fig-width: 10
#| fig-height: 4
#| label: fig-nma-education-completion-standard-nma
#| cache: true

# specify nma
education_network_meta_random_effects <- netmeta(
  TE = es,
  seTE = se,
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study,
  data = education_component_es_data, 
  reference.group = "SAU",
  sm = "SMD", 
  nchar.trts = 30,
  common = FALSE,
  drop.reference.group = TRUE)

# define labels
component_combination_labels <- c(
  "On-the-job Training + Other",
  "Life Skills + Off-the-job Training + Other",
  "Basic Skills + Other",
  "Basic Skills + Life Skills + Off-the-job Training + Other",
  "Basic Skills + Life Skills + Other",
  "Basic Skills + Life Skills + Coaching & Mentoring + Other",
  "Basic Skills + Off-the-job Training + Other",
  "Coaching & Mentoring + Other",
  "Basic Skills + Coaching & Mentoring + Other",
  "Off-the-job Training + On-the-job Training + Other",
  "Life Skills + Other",
  "Life Skills + Coaching & Mentoring + Other",
  "Other"
  )

# plot results
forest(education_network_meta_random_effects,
   studlab = component_combination_labels,     
   reference.group = "SAU",
   col.by = "black",
   xlim = c(-1, 1.5),
   addrow.subgroups = FALSE,
   fontsize = 10, 
   spacing = 0.7,
   leftcols = c("studlab", "prop.direct"),
   equal.size = FALSE,
   sortvar = -"TE",
   label.left = "Favours Usual Services",
   label.right = "Favours Intervention",
   drop.reference.group = TRUE)
```

### Visualise the network structure

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-structure
#| fig-cap: Network map for education completion NMA
#| fig-width: 15
#| fig-height: 10
#| label: fig-nma-education-completion-structure
#| crop: true
#| cache: true

# visualise network structure 
set.seed(268)

network_labels <- c(
  "Apprenticeships",                  
  "Basic Skills",                   
  "Basic Skills + Coaching & Mentoring + Other",           
  "Basic Skills + Life Skills + Coaching & Mentoring + Other",        
  "Basic Skills + Life Skills + Off-the-job Training + Coaching & Mentoring + Other", 
  "Basic Skills + Life Skills + Off-the-job Training + Other",    
  "Basic Skills + Life Skills + Other",            
  "Basic Skills + Off-the-job Training",            
  "Basic Skills + Off-the-job Training + Other",        
  "Basic Skills + Other",               
  "Coaching & Mentoring + Other",              
  "Life Skills + Coaching & Mentoring + Other",          
  "Life Skills + Off-the-job Training + Other",        
  "Life Skills + Other",               
  "Off-the-job Training",               
  "Off-the-job Training + On-the-job Training + Other",     
  "On-the-job Training",                
  "On-the-job Training + Other",           
  "Other",                  
  "Services as usual")

# produce plot
netgraph(
  education_network_meta_random_effects,
  plastic = FALSE,
  col = "#E06632",
  number.of.studies = TRUE,
  cex = 0.75,
  cex.num = 0.9,
  pos.number.of.studies = 0.7,
  labels = network_labels)
```

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-comp-vis
#| fig-cap: Heatmap showing the distribution of components among included studies for education completion
#| fig-width: 10
#| fig-align: 'left'
#| out.width: '75%'
#| dpi: 300 
#| label: fig-nma-education-completion-comp-vis
#| cache: true
#| crop: true

# visualise components included in NMA
education_nma_component_visualisation <- compdesc(
  model = education_network_meta_random_effects,
  sep = "+",
  digits = 0) 

education_nma_component_visualisation$heatmat +
  theme_minimal(base_size = 12) +
  theme(
    plot.background = element_rect(
      fill = "white",
      colour = "white")
  )
```

::: custom-footnote
**Plot Legend:**\
*BS:* Basic Skills, *LS:* Life Skills, *OFF-JT:* Off-the-job training, *ON-JT:* On-the-job-training, *C&M:* Coaching and mentoring, *OTH:* Other (residual) component.
:::

### Summary results in league table

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-netleague
#| tbl-cap: Relative effects of combinations of components of employment and skills programs on education completion
#| label: tbl-nma-education-completion-netleague
#| cache: true
#| crop: true

# calculate netleague table
education_completion_league <- netleague(
  x = education_network_meta_random_effects,
  direct = TRUE,
  digits = 2,
  overwrite = TRUE)

# extract random effects results
league_table_matrix <- education_completion_league$random

# convert the matrix to a data frame
league_education_completion_table_data_frame <- as.data.frame(league_table_matrix)

# declare function to wrap results
wrap_nma_results <- function(df) {
  # apply function
  df[] <- lapply(df, function(x) {
    # test if cell contains a square bracket (indication 95% CI result) and if so, apply function
    x <- ifelse(str_detect(x, "\\["), 
                str_replace(x, "\\s\\[", "\n["), # adds a new line before "["
                x)
    x <- str_replace(x, ";\\s", ";") # removes the space after ";" produced by the netleague() output
    x
  })
  
  return(df)
}

# declare function to insert a new line at the nearest "+"
insert_newline <- function(text, wrap_length) {
  # ensure text is character
  text <- as.character(text)
  
  # initialise output vector
  output <- character(length(text))
  
  for (i in seq_along(text)) {
    current_text <- text[i]
    if (str_detect(current_text, "\\+")) {
      plus_positions <- str_locate_all(current_text, "\\+")
      # check if plus_positions is not empty
      if (length(plus_positions[[1]]) > 0) {
        # extract positions of all "+" symbols
        start_positions <- plus_positions[[1]][,1]
        # find the nearest "+" before the wrap_length, if any
        target_position <- max(start_positions[start_positions < wrap_length], na.rm = TRUE)
        if (!is.na(target_position) && target_position > 0) {
          current_text <- substr(current_text, 1, target_position) %>% 
                          paste0("\n", substr(current_text, target_position + 1, nchar(current_text)))
        }
      }
    }
    output[i] <- current_text
  }
  
  return(output)
}

# declare function to wrap label
wrap_component_labels <- function(df, wrap_length) {
  df[] <- lapply(df, function(x) insert_newline(x, wrap_length))
  return(df)
}

# declare function to colour label cells
colour_labels <- function(df, colour, text_colour) {
  # apply specification to label cells
  for (i in 1:min(nrow(df), ncol(df))) {
    df[i, i] <- cell_spec(
      df[i, i], 
      background = colour, 
      color = text_colour,
      extra_css = 
        "margin: -8px; 
        padding: 8px; 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        font-weight: bold; 
        min-height: 60px;"
    )
  }
  df
}

# declare function to colour cells in upper matrix
colour_upper_matrix <- function(df, colour, text_colour) {
  # get dimensions
  n_rows <- nrow(df)
  n_cols <- ncol(df)
  # apply specification to cells in upper matrix
  for (row in 1:(n_rows - 1)) {
    for (col in (row + 1):n_cols) {
      df[row, col] <- cell_spec(
        df[row, col], 
        background = colour, 
        color = text_colour,
        extra_css = 
          "margin: -8px; 
          padding: 8px; 
          display: flex; 
          justify-content: center; 
          align-items: center; 
          min-height: 60px;"
      )
    }
  }
  df
}

# declare function to format cells in lower matrix
colour_lower_matrix <- function(df, colour, text_colour) {
  # get dimensions
  n_rows <- nrow(df)
  n_cols <- ncol(df)
  
  # apply specification to cells in lower matrix
  for (row in 2:n_rows) {
    for (col in 1:(row - 1)) {
      df[row, col] <- cell_spec(
        df[row, col], 
        background = colour, 
        color = text_colour,
        extra_css = 
          "margin: -8px; 
          padding: 8px; 
          display: flex; 
          justify-content: center; 
          align-items: center;
          min-height: 60px;"
      )
    }
  }
  df
  }

# set column names to NULL
colnames(league_education_completion_table_data_frame) <- NULL

# apply custom functions
formatted_league_education_completion_table_data_frame <- league_education_completion_table_data_frame %>%
  wrap_nma_results() %>%
  wrap_component_labels(10) %>%
  colour_labels("#E06632", "black") %>%
  colour_upper_matrix("#D1E8FF", "black") %>%
  colour_lower_matrix("#F0F0F0", "black")

# produce table
formatted_league_education_completion_table_data_frame %>%
  kable(
    "html", 
    escape = FALSE,
    align = "c"
  ) %>%
  kable_styling(
    full_width = FALSE
  ) %>%
  scroll_box(
      width = "100%", height = "900px") %>%
  column_spec(
    1:14, 
    width_min = "10em")
```

::: custom-footnote
**Notes:**\
Effect sizes (Hedge's g) are reported with 95% confidence intervals.\
Combinations of components (listed in alphabetical order) from included studies are shown in orange.\
Direct evidence (i.e., sourced from pairwise comparisons) are shown in blue.\
Indirect effects (i.e., from the NMA) are shown in gray.\
**Legend:**\
*BS:* Basic Skills, *LS:* Life Skills, *OFF-JT:* Off-the-job training, *ON-JT:* On-the-job-training, *C&M:* Coaching and mentoring, *OTH:* Other (residual) component.
:::

### Fit additive component NMA

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-additive
#| fig-cap: Forest plot showing the results of an additive CNMA for education completion
#| fig-height: 2.5
#| label: fig-nma-education-completion-additive
#| cache: true
#| crop: true

education_additive_component_network_meta <- netmeta::netcomb(
  x = education_network_meta_random_effects, 
  inactive = "SAU",
  sep.comps = "+",
  random = TRUE)

education_additive_component_network_meta_plot_data <- netcomplex(
  education_additive_component_network_meta,  
  education_additive_component_network_meta$comps)

component_labels <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other")

forest(
  education_additive_component_network_meta_plot_data,
  studlab = component_labels,
  reference.group = "SAU",
  col.by = "black",
  xlim = c(-0.5, 1),
  addrow.subgroups = FALSE,
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9,
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n",                   "(education completion)"),
  label.left = "Favours Usual Services",
  label.right = "Favours Intervention",
  drop.reference.group = TRUE,
  leftlabs = "Intervention component",
  sortvar = -education_additive_component_network_meta_plot_data$Comb.random
  )
```

### Fit interactive component NMAs

For education completion, the review team identified four potential pairs of components that could be combined in an interaction. They were:

-   On-the-job training x Other

-   Basic Skills x Other

-   Life Skills x Other

-   Coaching & Mentoring x Other

As with employment status, there were no significant differences in the impact of the components individually or interacting in any of these models --- these results are presented in the forest plots below.

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-interaction-onjt-oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between On-the-job training x Other for education completion
#| fig-height: 2.5
#| label: fig-nma-education-completion-interaction-onjt-oth
#| cache: true
#| crop: true

education_interaction_matrix_ojt_oth <- cbind(
  education_additive_component_network_meta$C.matrix, 
  `ON-JT+OTH` = 0) 
education_interaction_matrix_ojt_oth["ON-JT+OTH", "ON-JT+OTH"] <- 1

education_interaction_component_network_meta_ojt_oth <- netcomb(
  education_network_meta_random_effects, 
  C.matrix = education_interaction_matrix_ojt_oth, 
  inactive = "SAU")

education_interaction_component_network_meta_ojt_oth_plot_data <- netcomplex(
  education_interaction_component_network_meta_ojt_oth,
  education_interaction_component_network_meta_ojt_oth$comps)

component_labels <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "On-the-job Training x Other"
  )

forest(
  education_interaction_component_network_meta_ojt_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(education completion)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -education_interaction_component_network_meta_ojt_oth_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-interaction-ls-oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between Life Skills x Other for education completion
#| fig-height: 2.5
#| label: fig-nma-education-completion-interaction-ls-oth
#| cache: true
#| crop: true

education_interaction_matrix_ls_oth <- cbind(
  education_additive_component_network_meta$C.matrix, 
  `LS+OTH` = 0) 
education_interaction_matrix_ls_oth["LS+OTH", "LS+OTH"] <- 1

education_interaction_component_network_meta_ls_oth <- netcomb(
  education_network_meta_random_effects, 
  C.matrix = education_interaction_matrix_ls_oth, 
  inactive = "SAU")

education_interaction_component_network_meta_ls_oth_plot_data <- netcomplex(
  education_interaction_component_network_meta_ls_oth,
  education_interaction_component_network_meta_ls_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Life Skills x Other"
  )

forest(
  education_interaction_component_network_meta_ls_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(education completion)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -education_interaction_component_network_meta_ls_oth_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-interaction-bs-oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between Basic Skills x Other for education completion
#| fig-height: 2.5
#| label: fig-nma-education-completion-interaction-bs-oth
#| cache: true
#| crop: true

education_interaction_matrix_bs_oth <- cbind(
  education_additive_component_network_meta$C.matrix,
  `BS+OTH` = 0) 
education_interaction_matrix_bs_oth["BS+OTH", "BS+OTH"] <- 1

education_interaction_component_network_meta_bs_oth <- netcomb(
  education_network_meta_random_effects,
  C.matrix = education_interaction_matrix_bs_oth, 
  inactive = "SAU")

education_interaction_component_network_meta_bs_oth_plot_data <- netcomplex(
  education_interaction_component_network_meta_bs_oth,
  education_interaction_component_network_meta_bs_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Basic Skills x Other"
  )

forest(
  education_interaction_component_network_meta_bs_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(education completion)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -education_interaction_component_network_meta_bs_oth_plot_data$Comb.random
  )
```

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-interaction_cm_oth
#| fig-cap: Forest plot depicting results of CNMA with interaction between Coaching & Mentoring x Other for education completion
#| fig-height: 2.5
#| label: fig-nma-education-completion-interaction_cm_oth
#| cache: true
#| crop: true

education_interaction_matrix_cm_oth <- cbind(
  education_additive_component_network_meta$C.matrix, 
  `C&M+OTH` = 0) 
education_interaction_matrix_cm_oth["C&M+OTH", "C&M+OTH"] <- 1

education_interaction_component_network_meta_cm_oth <- netcomb( 
  education_network_meta_random_effects, 
  C.matrix = education_interaction_matrix_cm_oth, 
  inactive = "SAU")

education_interaction_component_network_meta_cm_oth_plot_data <- netcomplex(
  education_interaction_component_network_meta_cm_oth,
  education_interaction_component_network_meta_cm_oth$comps)

## EXPORT FOREST PLOT

component_labels <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other", 
  "Coaching & Mentoring x Other"
  )

forest(
  education_interaction_component_network_meta_cm_oth_plot_data, 
  studlab = component_labels, 
  reference.group = "SAU", 
  drop.reference.group = TRUE, 
  col.by = "black", 
  xlim = c(-0.5, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Program Components vs. Usual Services \n", "(education completion)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  sortvar = -education_interaction_component_network_meta_cm_oth_plot_data$Comb.random
  )
```

### Compare different NMA specifications

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-nma-comparison
#| fig-cap: Forest plot depicting results of Interaction, Additive and standard NMA of component combinations on education completion
#| fig-height: 23
#| label: fig-nma-education-completion-nma-comparison
#| cache: true
#| crop: true

# prep colour palette
colour_palette <- viridis_pal(
    begin = 0, 
    end = 0.8,
    direction = 1,
    option = "inferno"
  )(6)

# prepare plot data
education_forest_plot_data <- netbind(
  random = TRUE, 
  common = FALSE, 
  education_network_meta_random_effects, 
  education_additive_component_network_meta, 
  education_interaction_component_network_meta_ojt_oth,
  education_interaction_component_network_meta_bs_oth,
  education_interaction_component_network_meta_ls_oth,
  education_interaction_component_network_meta_cm_oth,
  name = c(
    "Standard NMA", 
    "Additive cNMA", 
    "On-the-job training x Other Interaction cNMA",
    "Basic Skills x Other Interaction cNMA",
    "Life Skills x Other Interaction cNMA",
    "Coaching & Mentoring x Other Interaction cNMA"
    ), 
  col.study = colour_palette, 
  col.square = colour_palette
  )

# plot different nma specifications
forest(
  education_forest_plot_data, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-0.75, 1.25), 
  addrow.subgroups = FALSE, 
  fontsize = 10, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Employment Program Components vs. Usual Services \n", "(education completion)"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  leftlabs = "Intervention component", 
  drop.reference.group = TRUE
  )
```

### Assess publication bias

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-pub-bias
#| fig-cap: Comparison-adjusted funnel plot for education completion
#| label: fig-nma-education-completion-pub-bias
#| fig-height: 6
#| cache: true
#| crop: true

order = c("SAU")

funnel(
  x = education_network_meta_random_effects,
  order = order,
  pooled = "random",
  lump.comparator = TRUE,
  text.comparator = "SAU",
  pch = c(11:21), 
  col = c(11:21),
  text.linreg = "(Egger)",
  method.bias = c("Egger"), digits.pval = 2)

# prepare input for eggers test 
# input_eggers <- funnel(
#   x = education_network_meta_random_effects,
#   order = order,
#   pooled = "random",
#   lump.comparator = TRUE,
#   text.comparator = "SAU")

# run eggers test
# metabias(metagen(TE.adj, seTE, data = input_eggers))
```

::: custom-footnote
**Plot Legend:**\
*BS:* Basic Skills, *LS:* Life Skills, *OFF-JT:* Off-the-job training, *ON-JT:* On-the-job-training, *C&M:* Coaching and mentoring, *OTH:* Other (residual) component.
:::

### Evaluate incoherence

#### Assessing local incoherence

It was not possible to apply the SIDE methodology to the network of studies reporting education completion outcomes due to the absence of any indirect evidence within that network.

#### Assessing global incoherence

It was not possible to assess global incoherence for the network of included studies reporting education outcomes due to the absence of any indirect evidence within that network.

### Subgroup analysis

#### Study confidence

Of the twenty-three (n=23) included studies reporting education completion outcomes, nine (n=9) were assessed as 'high confidence', and fourteen (n=14) were 'low or medium confidence'. In this case, there were insufficient studies to undertake a subgroup analysis.

#### Study population

Thirteen (n=13) of the included studies reporting education completion outcomes served populations who reported facing additional barriers, while the remaining ten (n=10) served populations who did not report facing additional barriers. In this case, there were insufficient studies to undertake a subgroup analysis by study population.

The results --- depicted in @fig-nma-education-completion-subgroup-study-population --- show that there are no significant differences in education completion outcomes by study population. Additionally, there are no significant differences in outcomes between populations. The wide confidence intervals depicted in the forest plots indicate both that the sample is underpowered and that our estimates are uncertain.

```{r}
#| echo: false
#| message: false
#| name: nma-education-completion-subgroup-study-population
#| fig-cap: Forest plot depicting the result of subgroup analysis for education completion by study population
#| fig-subcap: 
#|   - "Studies involving young people\nwith reported additional barriers"
#|   - "Studies involving young people\nwithout reported additional barriers"
#| fig-height: 2
#| label: fig-nma-education-completion-subgroup-study-population
#| cache: true
#| layout-ncol: 1
#| crop: true

# subset data by study population
education_network_meta_random_effects_population_complex_needs_data <- education_component_es_data %>% 
  filter(complex_population == "Yes")

education_network_meta_random_effects_population_without_complex_needs_data <- education_component_es_data %>%
  filter(complex_population == "No")

# specify standard NMA for each subgroup
education_network_meta_random_effects_population_without_complex_needs <- netmeta(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = education_network_meta_random_effects_population_without_complex_needs_data, 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE
  )

# specify additive NMA for each subgroup
education_additive_component_network_meta_population_complex_needs <- discomb(
  TE = es, 
  seTE = se, 
  treat1 = intervention, 
  treat2 = comparison, 
  studlab = study, 
  data = education_network_meta_random_effects_population_complex_needs_data, 
  inactive = "SAU", 
  reference.group = "SAU", 
  sm = "SMD", 
  nchar.trts = 30, 
  common = FALSE, 
  drop.reference.group = TRUE)

education_additive_component_network_meta_population_without_complex_needs <- netcomb(
  x = education_network_meta_random_effects_population_without_complex_needs, 
  inactive = "SAU", 
  sep.comps = "+", 
  random = TRUE)

education_additive_component_network_meta_population_complex_needs_plot_data <- netcomplex(
  education_additive_component_network_meta_population_complex_needs,
  education_additive_component_network_meta_population_complex_needs$comps)

education_additive_component_network_meta_population_without_complex_needs_plot_data <- netcomplex(
  education_additive_component_network_meta_population_without_complex_needs,
  education_additive_component_network_meta_population_without_complex_needs$comps)

# visualise results
component_labels_barriers <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "Other"
  )

forest(
  education_additive_component_network_meta_population_complex_needs_plot_data, 
  studlab = component_labels_barriers, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-1, 1),
  addrow.subgroups = FALSE,
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9,
  smlab = "",
  #smlab = paste("Studies involving young people\nwith reported additional barriers"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -education_additive_component_network_meta_population_complex_needs_plot_data$Comb.random)

component_labels_no_barriers <- c(
  "Basic Skills", 
  "Coaching & Mentoring", 
  "Life Skills", 
  "Off-the-job Training", 
  "On-the-job Training", 
  "Other"
  )

forest(
  education_additive_component_network_meta_population_without_complex_needs_plot_data, 
  studlab = component_labels_no_barriers, 
  reference.group = "SAU", 
  col.by = "black", 
  xlim = c(-1, 1), 
  addrow.subgroups = FALSE, 
  fontsize = 7, 
  spacing = 0.7, 
  squaresize = 0.9, 
  smlab = "",
  #smlab = paste("Studies involving young people\nwithout reported additional barriers"), 
  label.left = "Favours Usual Services", 
  label.right = "Favours Intervention", 
  drop.reference.group = TRUE, 
  leftlabs = "Intervention component", 
  sortvar = -education_additive_component_network_meta_population_without_complex_needs_plot_data$Comb.random)
```

#### Study location

Of the twenty-three (n=23) included studies reporting education completion outcomes, twenty-two (n=22) were from the United States, which did not allow for subgroup analysis by study location.

### Sensitivity analysis

Of the twenty-three (n=23) studies reporting education completion outcomes, all but three (n=20) use randomised designs. This meant that it was not possible to undertake sensitivity analysis by study design for this outcome.

<h1>References</h1>

::: {#refs}
:::